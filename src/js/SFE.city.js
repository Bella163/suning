var ECity=ECity||{};ECity.setting={},ECity.setting.data={cookie:{cookieKey:"SN_CITY",userCookieKey:"addr_link_detial",cookieVale:"",userCookieValue:"",userAddrSeparator:"_",hostName:"",userAddressHostName:"",streetSolpHostName:"",cityOuterSepatator:"|",cityInnerSeparator:"_",cookiePath:"",cookieTime:"",cookieDomain:"",oldCookieCityKey:"cityId",oldCookieDistrictKey:"districtId",oldCookieCityValue:"",oldCookieDistrictValue:"",hostDomain:"",protocol:"",port:"",protocolSepatator:"//",portSepatator:":",root:"/ip-web",inited:!1},url:{cookieUrl:"",cityArrayUrl:"",districtArrayUrl:"",districtUrl:"",lesUrl:"",userAddrUrl:"",userAddrStreetSolpUrl:""},flag:{user:"1",sys:"2",sys_user:"3",fail_query:"4",sys_error:"5"},type:{pc:"pc",pcd:"pcd"},city:{cityArray:[],cityType:"",cityInfo:{}},user:{hasInit:!1,addressList:[],selectAddr:{}},init:function(e){var t=ECity.setting.data,i=t.cookie,n=t.url,o=t.city,a=t.type;i.inited=!0;var r=document.location.hostname;i.hostName=document.location.hostname,i.hostDomain=document.location.hostname,i.protocol=document.location.protocol,i.port=document.location.port;var s=new Date;s.setFullYear(s.getFullYear()+1),i.cookieTime="; expires = "+s.toUTCString(),i.cookiePath="; path = /",-1!=r.indexOf(".suning.com")?(i.cookieDomain="; domain =.suning.com",i.hostName=i.protocol+"//ipservice.suning.com",i.userAddressHostName=i.protocol+"//my.suning.com",i.streetSolpHostName=i.protocol+"//solp.suning.com"):-1!=r.indexOf(".cnsuning.com")?(i.cookieDomain="; domain =.cnsuning.com",-1!=r.indexOf("sit")?(i.hostName=i.protocol+"//ipservicepre.cnsuning.com",i.userAddressHostName=i.protocol+"//mysit.cnsuning.com",i.streetSolpHostName=i.protocol+"//solpsit.cnsuning.com"):-1!=r.indexOf("pre")&&(i.hostName=i.protocol+"//ipservicepre.cnsuning.com",-1!=r.indexOf("xgpre")||-1!=r.indexOf("prexg")?(i.userAddressHostName=i.protocol+"//myprexg.cnsuning.com",i.streetSolpHostName=i.protocol+"//solpxgpre.cnsuning.com",i.hostName=i.protocol+"//ipservicexgpre.cnsuning.com"):(i.userAddressHostName=i.protocol+"//mypre.cnsuning.com",i.streetSolpHostName=i.protocol+"//solppre.cnsuning.com"))):(i.cookieDomain+=i.hostName,i.hostName="http://localhost:8080/ip-web",i.userAddressHostName=i.protocol+"//mypre.cnsuning.com",i.streetSolpHostName=i.protocol+"//solp.suning.com"),n.cookieUrl=i.hostName+"/ipQuery.do?",n.provinceArrayUrl=i.hostName+"/provinceList-",n.cityArrayUrl=i.hostName+"/cityList-",n.districtArrayUrl=i.hostName+"/districtList-",n.districtUrl=i.hostName+"/districtDetail-",n.lesUrl=i.hostName+"/cityAndDistrict-",n.provinceAndCityUrl=i.hostName+"/provinceAndCity-",n.cityMapById=i.hostName+"/cityMapById-",n.reportIpUrl=i.hostName+"/report/reportIp.do?",n.reportSwitchUrl=i.hostName+"/report/querySwitch.htm",n.userAddrUrl=i.userAddressHostName+"/urbanLink/queryAddressInfo4Level.do",n.userAddrStreetSolpUrl=i.streetSolpHostName+"/solp/http/SOLP10201_",o.cityType=e?a.pc:a.pcd}},ECity.setting.util={equalsByPCDForLES:function(e,t){if(!e||!t)return!1;try{if(parseInt(e.pLesId,10)==parseInt(t.pLesId,10)&&e.cLesId==t.cLesId&&e.dLesId==t.dLesId)return!0}catch(e){}return!1},equalsByPCD:function(e,t){return!(!e||!t)&&(e.provinceMDMId==t.provinceMDMId&&e.cityMDMId==t.cityMDMId&&e.districtCommerceId==t.districtCommerceId)},equalsByPC:function(e,t){return!(!e||!t)&&(e.provinceMDMId==t.provinceMDMId&&e.cityMDMId==t.cityMDMId)},isEmpty:function(e){if(!e)return!0;for(var t in e)if(void 0!==e[t])return!1;return!0},equalsByCD:function(e,t,i){if(!e)return null;if(!t)return null;if(!i||0==i.length)return null;for(var n in i)if(e===i[n].cityCommerceId&&t===i[n].districtCommerceId)return i[n];return null},equalsByC:function(e,t){if(!e)return null;if(!t||0==t.length)return null;for(var i in t)if(e===t[i].cityCommerceId)return t[i];return null},convertToOut:function(e){if(!e||this.isEmpty(e))return null;var t={};return t.province={},t.city={},t.district={},t.town={},t.province.id=e.provinceMDMId,t.province.cid=e.provinceCommerceId,t.province.name=e.provinceName,t.city.id=e.cityMDMId,t.city.cid=e.cityCommerceId,t.city.lesId=e.cityLESId,t.city.name=e.cityName,t.district.id=e.districtMDMId,t.district.cid=e.districtCommerceId,t.district.lesId=e.districtLESId,t.district.name=e.districtName,t.town.id=e.townMDMId,t.town.cid=e.townCommerceId,t.town.lesId=e.townLESId,t.town.name=e.townName,t},convertToIn:function(e){if(!e||this.isEmpty(e))return null;var t={};return e.province&&!this.isEmpty(e.province)&&(t.provinceMDMId=e.province.id,t.provinceCommerceId=e.province.cid,t.provinceName=e.province.name),e.city&&!this.isEmpty(e.city)&&(t.cityMDMId=e.city.id,t.cityCommerceId=e.city.cid,t.cityLESId=e.city.lesId,t.cityName=e.city.name),e.district&&!this.isEmpty(e.district)&&(t.districtMDMId=e.district.id,t.districtLESId=e.district.lesId,t.districtCommerceId=e.district.cid,t.districtName=e.district.name),e.town&&!this.isEmpty(e.town)&&(t.townMDMId=e.town.id,t.townLESId=e.town.lesId,t.townCommerceId=e.town.cid,t.townName=e.town.name),t},isLogin:function(){return-1!==document.cookie.indexOf("logonStatus")},getCityMapByLesId:function(e,t){var i=ECity.setting.data.url.cityMapById+e.provinceId+"-"+e.cityId+"-"+e.districtId+"-cityMapCallback.htm",n={};$.ajax({type:"GET",url:i,cache:!0,async:!0,dataType:"jsonp",jsonp:!1,jsonpCallback:"cityMapCallback",success:function(e){e=e||{},n.provinceMDMId=e.pMdmId,n.provinceLESId=e.pMdmId,n.provinceName=e.pName,n.provinceCommerceId="",n.cityLESId=e.cLesId,n.cityMDMId=e.cMdmId,n.cityCommerceId=e.cCommerceId,n.cityName=e.cName,n.districtLESId=e.dLesId,n.districtCommerceId=e.dCommerceId||"",n.districtMDMId="",n.districtName=e.dName,n.provinceName?t(null,n):t(!0)}})},formatShowUserAddress:function(e,t,i){(e=e||{}).stateName=e.stateName||"",e.cityName=e.cityName||"",e.townName=e.townName||"",e.streetName=e.streetName||"",e.detailAddress=e.detailAddress||"";var n="";t?(n=e.streetName,i&&e.detailAddress.length>10?n+=e.detailAddress.slice(0,9)+"...":n+=e.detailAddress):(n=e.stateName,e.stateName!==e.cityName&&(n+=e.cityName),n+=e.townName+e.streetName,i&&e.detailAddress.length>10?n+=e.detailAddress.slice(0,10)+"...":n+=e.detailAddress);return n},getStreetSolpByData:function(e,t){var i=ECity.setting.util.uuid(),n=e.city+""+e.town+e.street,o=i+"_"+encodeURIComponent(e.cityName||"")+"_"+encodeURIComponent(e.townName||"")+"_"+encodeURIComponent(e.streetName||"");o+="_"+encodeURIComponent(e.detailAddress||""),o+="_"+n;var a=ECity.setting.data.url.userAddrStreetSolpUrl+o+"_resolveTransportRegion.htm";$.ajax({type:"GET",url:a,cache:!0,async:!0,dataType:"jsonp",timeout:"3000",jsonp:!1,jsonpCallback:"showTransportRegion",success:function(e){var i=(e=e||{}).tzone||"";if(i)if(i&&7===i.length){var n=i.slice(5);n&&2===n.length?t(null,n):t(!0)}else t(!0);else t(!0)},error:function(e){console.error(e),t(!0)}})},uuid:function(){for(var e=[],t=0;t<36;t++)e[t]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]="0123456789abcdef".substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="",e.join("")}},ECity.IPCookie=function(){var e=ECity.setting.data,t=ECity.setting.util,i=e.cookie,n=e.flag,o=e.type,a=e.city,r=e.url,s=e.user,c=[];var d=[];var l=[];var p=[];var u=function(e){if(h(),i.cookieValue){var t=i.cookieValue.split(i.cityOuterSepatator);C(t,e)}else y(e)},y=function(e){A();var n={};i.oldCookieCityValue?i.oldCookieDistrictValue?(n=t.equalsByCD(i.oldCookieCityValue,i.oldCookieDistrictValue,a.cityArray))?(a.cityInfo=n,t.equalsByPCD(n,a.cityArray[0])||(D(),x()),"function"==typeof e&&e(t.convertToOut(a.cityInfo))):v(e):(n=t.equalsByC(i.oldCookieCityValue,a.cityArray))?(a.cityInfo=n,b(),t.equalsByPCD(n,a.cityArray[0])||(D(),x()),"function"==typeof e&&e(t.convertToOut(a.cityInfo))):v(e):a.cityArray&&0!=a.cityArray.length?(a.cityInfo=a.cityArray[0],b(),"function"==typeof e&&e(t.convertToOut(a.cityInfo))):v(e)},m=function(){var e=a.cityArray,i=a.cityInfo;if(e&&!t.isEmpty(e[0])&&e[0].flag==n.user){var o=r.reportSwitchUrl;$.ajax({type:"GET",url:o,cache:!0,async:!1,jsonp:!1,dataType:"jsonp",jsonpCallback:"switchcallback",success:function(e){1==e.returnCode&&0==e.switchValue&&f(i.cityLESId)},error:function(e,t,i){}})}},f=function(e){var t=r.reportIpUrl+"cityId="+e;$.ajax({type:"GET",url:t,cache:!0,async:!1,jsonp:!1,dataType:"jsonp",jsonpCallback:"reportIpcallback",success:function(e){},error:function(){}})},h=function(){var e=document.cookie;if(e){var t=e.match(RegExp("(^| )"+i.oldCookieCityKey+"=([^;]*)(;|$)")),n=e.match(RegExp("(^| )"+i.oldCookieDistrictKey+"=([^;]*)(;|$)")),o=e.match(RegExp("(^| )"+i.cookieKey+"=([^;]*)(;|$)")),a=e.match(RegExp("(^| )"+i.userCookieKey+"=([^;]*)(;|$)"));t&&t[2]&&0!=t[2].length&&(i.oldCookieCityValue=decodeURIComponent(t[2])),n&&n[2]&&0!=n[2].length&&(i.oldCookieDistrictValue=decodeURIComponent(n[2])),o&&o[2]&&0!=o[2].length&&(i.cookieValue=decodeURIComponent(o[2])),a&&a[2]&&0!=a[2].length&&(i.userCookieValue=decodeURIComponent(a[2]))}},v=function(e){var t;t=e,1==(c=c.concat(t)).length&&g(e)},g=function(e){var o=r.cookieUrl;i.oldCookieCityValue&&(o+=i.oldCookieCityKey+"="+i.oldCookieCityValue,i.oldCookieDistrictValue&&(o+="&"+i.oldCookieDistrictKey+"="+i.oldCookieDistrictValue)),$.ajax({type:"GET",url:o,cache:!0,async:!1,dataType:"jsonp",jsonpCallback:"cookieCallback",success:function(o){var r=[];if(i.oldCookieCityValue?i.oldCookieDistrictValue?(o.flag=n.user,o.count=1):(o.flag=n.sys_user,o.count=0):(o.flag=n.sys,o.count=0),0==o.status&&(o.flag=n.fail_query),a.cityInfo=o,a.cityArray&&0!=a.cityArray.length?D():(r.push(o),a.cityArray=r),x(),i.oldCookieCityValue&&i.oldCookieDistrictValue&&i.oldCookieDistrictValue!=o.districtCommerceId&&b(),i.oldCookieCityValue&&i.oldCookieDistrictValue||b(),"function"==typeof e){for(var s in c)c[s](t.convertToOut(a.cityInfo));c=[]}}})};var C=function(e,n){var o=e[0].split(i.cityInnerSeparator),s={},c=o[0],d=o[1],l=o[4],p=r.cityMapById+c+"-"+d+"-"+l+"-cityMapCallback.htm";$.ajax({type:"GET",url:p,cache:!0,async:!0,dataType:"jsonp",jsonp:!1,jsonpCallback:"cityMapCallback",success:function(i){"1"==i.returnCode?(s.provinceMDMId=i.pMdmId,s.provinceLESId=i.pMdmId):(s.provinceMDMId=o[0],s.provinceLESId=o[0]),s.provinceCommerceId="",s.provinceName=i.pName,"2"==i.returnCode?(s.cityLESId=i.cLesId,s.cityMDMId=i.cMdmId,s.cityCommerceId=i.cCommerceId):(s.cityLESId=o[1],s.cityMDMId=o[2],s.cityCommerceId=o[3]),s.cityName=i.cName,"3"==i.returnCode||"2"==i.returnCode?(s.districtLESId=i.dLesId,s.districtCommerceId=i.dCommerceId):(s.districtLESId=o[4],s.districtCommerceId=o[5]),s.districtMDMId="",s.districtName=i.dName,s.flag=o[6],s.count=o[7];for(var r=!1,c=a.cityArray.length,d=0;d<c;d++)t.equalsByPCD(a.cityArray[d],s)&&(r=!0);r||a.cityArray.push(s),e.shift(),"0"!=i.returnCode&&(I(),x()),1==a.cityArray.length&&"0"!=i.returnCode&&(k(),b()),0==e.length?y(n):C(e,n)}})},I=function(){var e=new Date;e.setTime(e.getTime()-1e4),cookieTemp=i.cookieKey+"="+encodeURIComponent(""),cookieTemp+="; expires = "+e.toGMTString(),cookieTemp+=i.cookiePath,cookieTemp+=i.cookieDomain,document.cookie=cookieTemp},k=function(){var e=new Date;e.setTime(e.getTime()-1e4),cookieCity=i.oldCookieCityKey+"="+encodeURIComponent(""),cookieCity+="; expires = "+e.toGMTString(),cookieCity+=i.cookiePath,cookieCity+=i.cookieDomain,document.cookie=cookieCity,i.oldCookieCityValue="",cookieDistrict=i.oldCookieDistrictKey+"="+encodeURIComponent(""),cookieDistrict+="; expires = "+e.toGMTString(),cookieDistrict+=i.cookiePath,cookieDistrict+=i.cookieDomain,document.cookie=cookieDistrict,i.oldCookieDistrictValue=""},A=function(){var e=a.cityArray;if(e&&0!=e.length)for(var t=e.length,n=0;n<t;n++){var o=e[n];if((o.provinceMDMId==o.cityLESId||!o.cityLESId||"null"==o.cityLESId||void 0===o.cityLESId||"null"==o.districtLESId||void 0===o.districtLESId||void 0===o.cityName||void 0===o.districtName)&&i.cookieValue){var r=new Date;r.setTime(r.getTime()-1e4),cookieTemp=i.cookieKey+"="+encodeURIComponent(""),cookieTemp+="; expires = "+r.toGMTString(),cookieTemp+=i.cookiePath,cookieTemp+=i.cookieDomain,document.cookie=cookieTemp,cookieCity=i.oldCookieCityKey+"="+encodeURIComponent(""),cookieCity+="; expires = "+r.toGMTString(),cookieCity+=i.cookiePath,cookieCity+=i.cookieDomain,document.cookie=cookieCity,i.oldCookieCityValue="",cookieDistrict=i.oldCookieDistrictKey+"="+encodeURIComponent(""),cookieDistrict+="; expires = "+r.toGMTString(),cookieDistrict+=i.cookiePath,cookieDistrict+=i.cookieDomain,document.cookie=cookieDistrict,i.oldCookieDistrictValue="",a.cityArray=null;break}}},b=function(){var e=a.cityArray;if(e&&0!=e.length){i.oldCookieCityValue=e[0].cityCommerceId,i.oldCookieDistrictValue=e[0].districtCommerceId;var t="",n="";t=i.oldCookieCityKey+"="+encodeURIComponent(i.oldCookieCityValue),t+=i.cookieTime,t+=i.cookiePath,t+=i.cookieDomain,document.cookie=t,n=i.oldCookieDistrictKey+"="+encodeURIComponent(i.oldCookieDistrictValue),n+=i.cookieTime,n+=i.cookiePath,n+=i.cookieDomain,document.cookie=n}},x=function(){var e=a.cityArray,t="",n="";if(e&&0!=e.length){for(var o=e.length,r=0;r!=o&&(n+=e[r].provinceMDMId,n+=i.cityInnerSeparator,n+=e[r].cityLESId,n+=i.cityInnerSeparator,n+=e[r].cityMDMId,n+=i.cityInnerSeparator,n+=e[r].cityCommerceId,n+=i.cityInnerSeparator,n+=e[r].districtLESId,n+=i.cityInnerSeparator,n+=e[r].districtCommerceId,n+=i.cityInnerSeparator,n+=e[r].flag,n+=i.cityInnerSeparator,n+=e[r].count,r!=o-1);r++)n+=i.cityOuterSepatator;i.cookieValue=n,t=i.cookieKey+"="+encodeURIComponent(i.cookieValue),t+=i.cookieTime,t+=i.cookiePath,t+=i.cookieDomain,document.cookie=t}},D=function(){var e=a.cityArray,i=a.cityType,r=a.cityInfo;if(!t.isEmpty(r)&&e&&!t.isEmpty(e[0])){var s=[],c=e[0],d=e[1],l=e[2];if(i==o.pc){if(c.flag==n.sys||c.flag==n.fail_query)return r.flag=n.sys_user,r.count=0,s.push(r),void(a.cityArray=s);if(c.flag==n.sys_user)return t.equalsByPC(r,c)?void 0:t.equalsByPC(r,d)?(s.push(d),t.isEmpty(l)||s.push(l),void(a.cityArray=s)):t.equalsByPC(r,l)?(s.push(l),s.push(d),void(a.cityArray=s)):(r.flag=n.sys_user,r.count=0,s.push(r),t.isEmpty(d)||(s.push(d),t.isEmpty(l)||s.push(l)),void(a.cityArray=s));if(c.flag==n.user)return t.equalsByPC(r,c)?void 0:t.equalsByPC(r,d)?(s.push(d),s.push(c),t.isEmpty(l)||s.push(l),void(a.cityArray=s)):t.equalsByPC(r,l)?(s.push(l),s.push(c),s.push(d),void(a.cityArray=s)):(r.flag=n.sys_user,r.count=0,s.push(r),s.push(c),t.isEmpty(d)||s.push(d),void(a.cityArray=s))}else{if(c.flag==n.sys||c.flag==n.fail_query)return r.flag=n.user,r.count=1,s.push(r),void(a.cityArray=s);if(c.flag==n.sys_user)return t.equalsByPCD(r,c)?(c.count++,void(c.flag=n.user)):t.equalsByPCD(r,d)?(d.count++,s.push(d),t.isEmpty(l)||s.push(l),void(a.cityArray=s)):t.equalsByPCD(r,l)?(l.count++,s.push(l),s.push(d),void(a.cityArray=s)):(r.flag=n.user,r.count=1,s.push(r),t.isEmpty(d)||(s.push(d),t.isEmpty(l)||s.push(l)),void(a.cityArray=s));if(c.flag==n.user)return t.equalsByPCD(r,c)?void c.count++:t.equalsByPCD(r,d)?(d.count++,s.push(d),s.push(c),t.isEmpty(l)||s.push(l),void(a.cityArray=s)):t.equalsByPCD(r,l)?(l.count++,s.push(l),s.push(c),s.push(d),void(a.cityArray=s)):(r.flag=n.user,r.count=1,s.push(r),s.push(c),t.isEmpty(d)||s.push(d),void(a.cityArray=s))}}},N=function(e,t){var i=r.cityArrayUrl+e+"_20150401-cityListCallback.htm";$.ajax({type:"GET",url:i,cache:!0,async:!0,dataType:"jsonp",jsonp:!1,jsonpCallback:"cityListCallback",success:function(e){for(var i=[],n=[],o=(i=e.cities).length,a=0;a!=o;a++){var r={};r.name=i[a].name,r.id=i[a].mdmId,r.cid=i[a].commerceId,r.lesId=i[a].lesId,r.pinyin=i[a].pinyin.charAt(0),r.defaultId=i[a].defaultDistrictMdmId,n.push(r)}if("function"==typeof t){a=0;for(var s=l.length;a<s;a++){var c=l[a];c&&c(n)}l=[]}}})},E=function(e,t){var i=r.districtArrayUrl+e+"_20150401-districtListCallback.htm";$.ajax({type:"GET",url:i,cache:!0,async:!0,dataType:"jsonp",jsonp:!1,jsonpCallback:"districtListCallback",success:function(e){for(var i=[],n=[],o=(i=e.districts).length,a=0;a!=o;a++){var r={};r.name=i[a].name,r.id=i[a].mdmId,r.cid=i[a].commerceId,r.lesId=i[a].lesId,r.pinyin=i[a].pinyin.charAt(0),n.push(r)}if("function"==typeof t){a=0;for(var s=p.length;a<s;a++){var c=p[a];c&&c(n)}p=[]}}})},P=function(e){var t=r.provinceArrayUrl+"provinceListCallback.htm";$.ajax({type:"GET",url:t,cache:!0,async:!0,dataType:"jsonp",jsonp:!1,jsonpCallback:"provinceListCallback",success:function(t){for(var i=[],n=[],o=(i=t.provinces).length,a=0;a!=o;a++){var r={};r.name=i[a].name,r.id=i[a].mdmId,r.cid=i[a].commerceId,r.pinyin=i[a].pinyin.charAt(0),r.defaultId=i[a].defaultCityMdmId,n.push(r)}if("function"==typeof e){a=0;for(var s=d.length;a<s;a++){var c=d[a];c&&c(n)}d=[]}}})},S=function(){var e=i.userCookieValue,t=null;if(e){var n=e.split(i.userAddrSeparator);n.length>0&&(t={addrNum:n[0],cntctPointName:decodeURIComponent(n[1]),state:n[2],stateName:decodeURIComponent(n[3]),city:n[4],cityName:decodeURIComponent(n[5]),town:n[6],townName:decodeURIComponent(n[7]),street:n[8],streetName:decodeURIComponent(n[9]),detailAddress:decodeURIComponent(n[10])})}return t};return{showCity:u,setCity:function(e,i){e&&!t.isEmpty(e)&&(a.cityInfo=t.convertToIn(e)),m(),D(),b(),x(),"function"==typeof i&&i(t.convertToOut(a.cityInfo))},getRemoteDistrict:function(e,t){var i=r.districtUrl+e+"_20150401-districtCallback.htm";$.ajax({type:"GET",url:i,cache:!0,async:!0,dataType:"jsonp",jsonp:!1,jsonpCallback:"districtCallback",success:function(e){var i={};"function"==typeof t&&(i.id=e.mdmId,i.cid=e.commerceId,i.lesId=e.lesId,i.name=e.name,t(i))}})},getRemoteDistrictArray:function(e,t){var i;i=t,1==(p=p.concat(i)).length&&E(e,t)},getRemoteCityArray:function(e,t){var i;i=t,1==(l=l.concat(i)).length&&N(e,t)},getRemoteProvinceArray:function(e){var t;t=e,1==(d=d.concat(t)).length&&P(e)},getProvinceAndCityByCityId:function(e,t){var i=r.provinceAndCityUrl+e+"-provinceandcityCallBack.htm";$.ajax({type:"GET",url:i,cache:!0,async:!0,dataType:"jsonp",jsonp:!1,jsonpCallback:"provinceandcityCallBack",success:function(e){var i={},n={};"function"==typeof t&&(n.pMdmId=e.pMdmId,n.pName=e.pName,n.cMdmId=e.cMdmId,n.cCommerceId=e.cCommerceId,n.cName=e.cName,i.provinceAndCity=n,t(i))}})},getUserAddressList:function(e){s.hasInit?e(!1,s.addressList):$.ajax({type:"GET",url:r.userAddrUrl,dataType:"jsonp",success:function(t){s.hasInit=!0,"success"==t.status?(s.addressList=t.contactPointList,e(!1,s.addressList)):e(t.msg||"error")},error:function(t){e(!0)}})},getUserSelectAddress:S,setUserAddress:function(e){var t,n,o=e.addrNum+i.userAddrSeparator;o+=e.cntctPointName+i.userAddrSeparator,o+=e.state+i.userAddrSeparator,o+=e.stateName+i.userAddrSeparator,o+=e.city+i.userAddrSeparator,o+=e.cityName+i.userAddrSeparator,o+=e.town+i.userAddrSeparator,o+=e.townName+i.userAddrSeparator,o+=e.street+i.userAddrSeparator,o+=e.streetName+i.userAddrSeparator,o+=e.detailAddress,i.userCookieValue=o,t=i.userCookieValue,n="",n=i.userCookieKey+"="+encodeURIComponent(t),n+=i.cookieTime,n+=i.cookiePath,n+=i.cookieDomain,document.cookie=n},removeUserAddress:function(){i.userCookieValue="";var e=new Date,t="";e.setTime(e.getTime()-1e4),t=i.userCookieKey+"="+encodeURIComponent(""),t+="; expires = "+e.toGMTString(),t+=i.cookiePath,t+=i.cookieDomain,document.cookie=t},getUserAddressById:function(e){var t=null;if(!e)return t;var i=s.addressList,n=i.length;if(n>0)for(var o=0;o<n;o++){var a=i[o];if(a.addrNum==e){t=a;break}}else{var r=S();r.addrNum&&r.addrNum==e&&(t=r)}return t},initCookie:function(e){"function"!=typeof e&&(e=$.noop),u(e)}}}(),ECity.API={init:function(e){ECity.setting.data.init(e)},ipCookie:ECity.IPCookie,util:ECity.setting.util,getCity:function(e){this.ipCookie.showCity(e)},setCity:function(e,t){this.ipCookie.setCity(e,t)},getDataCity:function(){var e=ECity.setting.data.city.cityArray,t={};return e&&!this.util.isEmpty(e[0])&&(t=this.util.convertToOut(e[0])),t},getLastUsedCities:function(){var e=ECity.setting.data.city.cityArray,t=[];if(e)for(var i in e)t.push(this.util.convertToOut(e[i]));return t},getCityId:function(){var e=ECity.setting.data.city.cityArray;return e&&!this.util.isEmpty(e[0])?e[0].cityCommerceId:""},getDistrictId:function(){var e=ECity.setting.data.city.cityArray;return e&&!this.util.isEmpty(e[0])?e[0].districtCommerceId:""},getDistrict:function(e,t){this.ipCookie.getRemoteDistrict(e,t)},getDistrictList:function(e,t){this.ipCookie.getRemoteDistrictArray(e,t)},getCityList:function(e,t){this.ipCookie.getRemoteCityArray(e,t)},getProvinceList:function(e){this.ipCookie.getRemoteProvinceArray(e)},getProvinceAndCityByCityId:function(e,t){this.ipCookie.getProvinceAndCityByCityId(e,t)},getUserAddressList:function(e){this.ipCookie.getUserAddressList(e)},getUserSelectAddress:function(){return this.ipCookie.getUserSelectAddress()},removeUserAddress:function(){this.ipCookie.removeUserAddress()},getUserAddressById:ECity.IPCookie.getUserAddressById,setUserAddress:ECity.IPCookie.setUserAddress,updateUserAddressCookie:function(e,t){var i=e||{};t="function"==typeof t?t:$.noop;var n={};if(!function(){for(var e=!0,t=["addrNum","cntctPointName","state","stateName","city","cityName","town","townName","street","streetName","detailAddress"],n=0,o=t.length;n<o;n++)if(!(""+i[t[n]])){e=!1;break}return e}())return t("params is invalid"),!1;var o={provinceId:i.state,cityId:i.city,districtId:i.town};ECity.API.util.getCityMapByLesId(o,function(e,o){e&&t("get city map error"),ECity.API.util.getStreetSolpByData(i,function(e,a){a&&(i.street=a),n.province={id:o.provinceMDMId,cid:o.provinceCommerceId,name:o.provinceName},n.city={id:o.cityMDMId,cid:o.cityCommerceId,lesId:o.cityLESId,name:o.cityName},n.district={id:o.districtMDMId,cid:o.districtCommerceId,lesId:o.districtLESId,name:o.districtName},n.town={id:"",cid:"",lesId:i.street,name:i.streetName},ECity.API.setUserAddress(i),ECity.API.setCity(n,function(e){t(!1,e)})})})}},function(e){"use strict";if(!window.jQuery)throw new Error("The plugin requires jQuery");var t=function(){if(this instanceof t==0)return new t};t.prototype={init:function(e,t){this.eles=e,this.opts=t,this.flag=!0,this.render()},render:function(){var e=this;this.setTemps(function(t){e.getCity(t)})},setTemps:function(t){var i=this,n=this.eles,o=this.opts;0==e("#ui-city-style").size()&&e("body").prepend(e('<style id="ui-city-style">ul,li,p,h3,h5,em,b,i,span,a{ margin: 0; padding: 0; }ul,li { list-style: none; }.clearfix:after{ content:"."; display:block; height:0; clear:both; visibility:hidden}.clearfix{ zoom:1}.ui-city a,.ui-city a:visited{ line-height:14px; color:#333; text-decoration: none; outline: none; cursor: pointer;}.ui-city a:hover { text-decoration:none; }.ui-city { display:inline-block;*dispplay:inline;*zoom:1; font-size: 12px; position: relative; z-index: 0}.ui-city .dn { display: none; }.ui-city .db { display: block; }.ui-city .dib { display: inline-block; }.ui-city .arr { display: inline-block; width: 0; height:0; border-color: #bbb transparent transparent; border-width: 5px; border-style: solid dashed dashed; font-size: 0; line-height: 0; overflow: hidden; }.ui-city a.ui-city-toggle:hover { color:#333;}.ui-city-toggle { display:inline-block; border: 1px solid #bbb; padding:6px 5px 6px 6px; color: #000;background: #fff; position: relative; z-index: 100}.ui-city-toggle .address-placement {font-style: normal; float: left;}.ui-city-toggle span { padding-right: 5px}.ui-city-toggle span:hover {color: #333;}.ui-city-toggle .arr { margin-right:5px;position: relative; top:5px; float: left;}.ui-city-group { display:none; position: absolute;background: #fff; left: 0; top:27px;border: 1px solid #ccc; margin-top:-1px; width: 420px; z-index: 99; box-shadow: 0 0 6px #ddd;padding-top:5px;}.ui-city-group .ui-city-close  { position: absolute;right: 0;top: 0;padding: 5px 10px;overflow: hidden;}.ui-city-group .ui-city-close i { font: 700 14px/1.5 simsun;margin-left:-4px; color: #aaa}.ui-city-group-header { padding-top: 10px;  }.ui-city-group-header .address-title { padding-left:15px; margin-bottom: 10px;}.ui-city-group-header .address-title span.show-more{color:#38d; cursor:pointer;}.ui-city-group-header .address-title span.wrapped b{border-style: dashed dashed solid;top: -2px;border-color: transparent transparent #38d;}.ui-city-group-header .address-title b.arr{position: relative;top:3px;left:5px;font-size:0;line-height:0;    border-color: #38d transparent transparent;}.ui-city-group-header .address-item {clear:both; padding-left:15px; margin-bottom: 10px; height:22px;overflow:hidden;margin-right:10px;}.ui-city-group-header .address-item.wrapped {height:110px;overflow:auto;}.ui-city-group-header .address-item.wrapped-2 {height:44px;}.ui-city-group-header .address-item.wrapped-3 {height:66px;}.ui-city-group-header .address-item.wrapped-4 {height:88px;}.ui-city-group-header .address-item a,.ui-city-group-header .address-item a{ display: block; height:22px; line-height:22px;zoom:1; padding:0 2px;color:#666;text-decoration: none;margin-right: 10px;width:auto}.ui-city-group-header .address-item a:hover {color: #f90; }.ui-city-group-header .address-item a.selected {color: #f90; }.ui-city-group-header .address-item a span.name { display:inline-block;width:48px;overflow:hidden;text-overflow: ellipsis; white-space: nowrap; margin-right: 10px;}.ui-city-group-header .address-item a span.address { display:inline-block;width:300px;overflow:hidden;text-overflow: ellipsis; white-space: nowrap;}.ui-city-group-content { margin: 10px 10px 0 10px; background:#fff;}.ui-city-group-content .nav-tabs { padding-left: 6px  }.ui-city-group-content .nav-tabs li {float: left; position: relative; z-index:2;border: 1px solid #ccc; height: 26px;background:#fff;margin-right: 6px; margin-bottom:0; cursor: pointer; }.ui-city-group-content .nav-tabs li p { padding: 6px 10px 6px 10px;border:1px solid #fff; }.ui-city-group-content .nav-tabs li a,.ui-city-group-content .nav-tabs li a:visited{ color: #999;float: left}.ui-city-group-content .nav-tabs li .arr { position: relative; top: 3px;left: 5px;font-size: 0; line-height: 0;}.ui-city-group-content .nav-tabs li.current { border: 2px solid #ffb84e; border-bottom:none; z-index: 4;}.ui-city-group-content .nav-tabs li.current p { padding: 6px 10px 5px 10px; position: relative; z-index: 4; border:none; }.ui-city-group-content .nav-tabs li.current .arr { border-color:  transparent transparent #f90; border-style:  dashed dashed solid; top:-2px; }.ui-city-group-content .nav-tabs li.current a,.ui-city-group-content .nav-tabs li.current a:visited{ display:inline-block; color: #333; }.ui-city-group-content .nav-tabs li.active a,.ui-city-group-content .nav-tabs li.active a:visited{ display:inline-block; color: #333; }.ui-city-group-content .tab-content { border-top: 2px solid #ffb84e;top:-2px;  position: relative; z-index: 3}.ui-city-group-content .tab-content .tab-panel { display: none; padding-top: 3px; padding-bottom: 15px; background: #fff;padding-left: 8px }.ui-city-group-content .tab-content .tab-panel.active { display: block;}.ui-city-group-content .tab-content li:after { content:"."; display:block; height:0; clear:both; visibility:hidden }.ui-city-group-content .tab-content li { *zoom:1;}.ui-city-group-content .tab-content li span {display:inline-block;width: 98px;}.ui-city-group-content .tab-content li a,.ui-city-group-content .tab-content li a:visited { display:inline-block; background:#fff;margin: 2px; padding: 5px; color:#000; }.ui-city-group-content .tab-content li a:hover { background: #f90; color: #fff;}.ui-city-group-content .tab-content li a.on,.ui-city-group-content .tab-content li a.on:visited { background: #f90;color: #fff; }.ui-city-group-content .tab-content .pr-panel li a{ }.ui-city.active { z-index: 10}.ui-city.active a.ui-city-toggle { border: 1px solid #ccc;background:#fff;border-bottom:none;box-shadow: 0 -1px 1px #ddd}.ui-city.active a.ui-city-toggle:hover { color: #333; background: #fff; text-decoration: none;}.ui-city.active a.ui-city-toggle .arr{ border-color:  transparent transparent #f90; border-style:  dashed dashed solid; top:0; }.ui-city.active .ui-city-group { display: block; }.ui-city .arr {transition:All .2s ease;-webkit-transition:All .2s ease;-moz-transition:All .2s ease;-o-transition:All .2s ease;-ms-transition:All .2s ease;}</style>'));var a,r=e('<div class="ui-city"></div>');e("a",i.eles).live("click",function(){return!1}),this.getInfo={},this.changeFlag=!0,this.queryInfo=function(e){""!=o.cityId&&void 0!=o.cityId?(o.city=!0,i.getAddressByDefault(function(){i.getInfoByCityid(o.cityId,function(i){e(i),setTimeout(function(){t(i)},10)})})):i.getAddressByDefault(function(i){e(i),setTimeout(function(){t(i)},10)})},this.queryInfo(function(t){var s=t.province,c=t.city,d=t.district,l=[s.id,s.cid,"",s.name].join(","),p=[c.id,c.cid,d.lesId,c.name].join(","),u=[d.id,d.cid,d.lesId,d.name].join(","),y=s.id;if(i.getInfo=t,a=/^10$|^20$|^30$|^320$/.test(y)?o.city?e('<a name="item_none_dizhi_01" href="###" class="ui-city-toggle" hidefocus="true"><em class="address-placement"><span id="provinceName" class="pr dn"  role='+l+">"+s.name+'</span><span id="citybName" class="ct"  role='+p+">"+c.name+'</span></em><b class="arr"></b></a>'):e('<a name="item_none_dizhi_01" href="###" class="ui-city-toggle" hidefocus="true"><em class="address-placement"><span id="provinceName" class="pr dn"  role='+l+">"+t.province.name+'</span><span class="ct" id="citybName" role='+p+">"+c.name+'</span><span id="districtName" class="ds" role='+u+">"+d.name+'</span></em><b class="arr"></b></a>'):o.city?e('<a name="item_none_dizhi_01" href="###" class="ui-city-toggle" hidefocus="true"><em class="address-placement"><span id="provinceName" class="pr"  role='+l+">"+s.name+'</span><span id="citybName" class="ct"  role='+p+">"+c.name+'</span></em><b class="arr"></b></a>'):e('<a name="item_none_dizhi_01" href="###" class="ui-city-toggle" hidefocus="true"><em class="address-placement"><span id="provinceName" class="pr"  role='+l+">"+s.name+'</span><span id="citybName" class="ct"  role='+p+">"+c.name+'</span><span id="districtName" class="ds" role='+u+">"+d.name+'</span></em><b class="arr"></b></a>'),o.used&&!o.city&&ECity.API.util.isLogin()){var m=i.getUserSelectAddress();if(m){var f={pLesId:m.state,cLesId:m.city,dLesId:m.town},h={pLesId:s.id,cLesId:c.lesId,dLesId:d.lesId};if(ECity.API.util.equalsByPCDForLES(f,h)){var v=ECity.API.util.formatShowUserAddress(m,!0,!0);a.find("em").append('<span id="detailAddress">'+v+"</span>")}else ECity.API.removeUserAddress()}}r.append(a),e(n).append(r),i.openPanel(o,t)})},openPanel:function(t,i){var n=this;e(this.eles).find(".ui-city").one("click.open",function(o){var a=o||a;return a&&a.stopPropagation(),n.getAllDetail(t,i),e(this).addClass("active"),!1})},closePanel:function(){var t=e(this.eles).find(".ui-city");e(this.eles).find(".ui-city-close").on("click.close",function(e){var i=e||i;return i&&i.stopPropagation(),t.removeClass("active"),!1}),e(document).not(this).on("click.close",function(){if(t.hasClass("active"))return t.removeClass("active"),!1})},getAllDetail:function(t,i){var n=this,o=this.eles,a=i.province,r=i.city,s=i.district,c=[a.id,a.cid,"",a.name,a.defaultId].join(","),d=[r.id,r.cid,r.lesId,r.name,r.defaultId].join(","),l=[s.id,s.cid,s.lesId,s.name].join(","),p=(a.id,e(this.eles).find(".ui-city")),u=p.find(".ui-city-toggle"),y=e('<div class="ui-city-group"></div>'),m=e('<a name="item_none_dizhi_guanbi" class="ui-city-close" href="###"><i>&gt;</i><i>&lt;</i></a>');y.append(m);var f=e('<div class="ui-city-group-header"><p class="address-title">常用地址： <span class="show-more">更多地址<b class="arr"></b></span></p></div>'),h=e('<div class="address-item"></div>');t.used&&!t.city&&ECity.API.util.isLogin()&&n._getUserAddressList(f,y,h,t);var v=e('<div class="ui-city-group-content"></div>');if(t.city)g=e('<ul class="nav-tabs clearfix"><li name="item_none_dizhi_02" id="provinceShow" class="active" role='+c+'><p><a href="###">'+a.name+'</a><b class="arr"></b></p></li><li name="item_none_dizhi_03" id="citybShow" class="active current" role='+d+","+r.defaultId+'><p><a href="###">'+r.name+'</a><b class="arr"></b></p></li></ul>');else var g=e('<ul class="nav-tabs clearfix"><li name="item_none_dizhi_02" id="provinceShow" class="active"  role='+c+'><p><a href="###">'+a.name+'</a><b class="arr"></b></p></li><li name="item_none_dizhi_03" id="citybShow" class="active"  role='+d+","+r.defaultId+'><p><a href="###">'+r.name+'</a><b class="arr"></b></p></li><li name="item_none_dizhi_04" id="districtShow" class="active current" role='+l+","+s.defaultId+'><p><a href="###">'+s.name+'</a><b class="arr"></b></p></li></ul>');var C=e('<div class="tab-content"></div>'),I=e('<ul class="tab-panel pr-panel"></ul><ul class="tab-panel ct-panel"><li>正在加载中...</li></ul><ul class="tab-panel ds-panel active"><li></li></ul>');if(n.setInfo=n.getInfo,t.state){var k=e("<li></li>");I.eq(0).append(k),n.getProvinceList(function(t){e.each(t,function(e,t){var i=[t.id,t.cid,"",t.name,t.defaultId].join(",");t.id==n.getInfo.province.id?I.children(":eq(0)").append('<span><a name="item_none_dizhi_sheng" href="###" class="on" role='+i+">"+t.name+"</a></span>"):I.children(":eq(0)").append('<span><a name="item_none_dizhi_sheng" href="###" role='+i+">"+t.name+"</a></span>")}),C.append(I),n.getProvinces(p,h,u,C,g,I,f,y,function(){return n.getCities(g,C,I,p,u,function(){return n.getDistricts(g,C,u,p,function(){return n.setDetailAddress(u,g,C,p)})})})})}v.append(g),v.append(C),y.append(v),p.append(y),e(o).append(p),n.closePanel(),g.find("li").each(function(t){e(this).on("click",function(i){return e(this).hasClass("active")&&(e(this).addClass("current").siblings().removeClass("current"),C.children(":eq("+t+")").addClass("active").siblings().removeClass("active")),!1})}),t.used&&!t.city&&ECity.API.util.isLogin()&&n.setAddressByUsed(h,u,p,I,C,g,f,y)},getProvinces:function(t,i,n,o,a,r,s,c,d){var l=this,p=this.opts;t.on("click",function(d){return d&&d.stopPropagation(),e(this).addClass("active"),void 0!==typeof i&&i.html(""),l.getUsedAddress(function(e){e&&p.used&&!p.city&&l._getUserAddressList(s,c,i,p)}),p.used&&!p.city&&l.setAddressByUsed(i,n,t,r,o,a,s,c),!1}),d()},setAddressByUsed:function(t,i,n,o,a,r,s,c){var d=this,l=this.opts;n.off("click.setDefaultAddress").on("click.setDefaultAddress",".address-item a",function(p){p&&p.stopPropagation();var u=e(this).clone().data("addr"),y=ECity.API.getUserAddressById(u);if(y){var m={provinceId:y.state,cityId:y.city,districtId:y.town};ECity.API.util.getCityMapByLesId(m,function(p,u){if(p)return!1;ECity.API.util.getStreetSolpByData(y,function(p,m){m&&(y.street=m),d.setInfo.province={id:u.provinceMDMId,cid:u.provinceCommerceId,name:u.provinceName},d.setInfo.city={id:u.cityMDMId,cid:u.cityCommerceId,lesId:u.cityLESId,name:u.cityName},d.setInfo.district={id:u.districtMDMId,cid:u.districtCommerceId,lesId:u.districtLESId,name:u.districtName},d.setInfo.town={id:"",cid:"",lesId:y.street,name:y.streetName};var f,h=ECity.API.util.formatShowUserAddress(y,!0,!0),v=[d.setInfo.province.id,d.setInfo.province.cid,"",d.setInfo.province.name].join(","),g=[d.setInfo.city.id,d.setInfo.city.cid,d.setInfo.district.lesId,d.setInfo.city.name].join(","),C=[d.setInfo.district.id,d.setInfo.district.cid,d.setInfo.district.lesId,d.setInfo.district.name].join(",");f=/^10$|^20$|^30$|^320$/.test(d.setInfo.province.id)?l.city?e('<span id="provinceName" class="pr dn"  role='+v+">"+d.setInfo.province.name+'</span><span id="citybName" class="ct"  role='+g+">"+d.setInfo.city.name+'</span><span id="detailAddress">'+h+"</span>"):e('<span id="provinceName" class="pr dn"  role='+v+">"+d.setInfo.province.name+'</span><span class="ct" id="citybName" role='+g+">"+d.setInfo.city.name+'</span><span id="districtName" class="ds" role='+C+">"+d.setInfo.district.name+'</span><span id="detailAddress">'+h+"</span>"):l.city?e('<span id="provinceName" class="pr"  role='+v+">"+d.setInfo.province.name+'</span><span id="citybName" class="ct"  role='+g+">"+d.setInfo.city.name+'</span><span id="detailAddress">'+h+"</span>"):e('<span id="provinceName" class="pr"  role='+v+">"+d.setInfo.province.name+'</span><span id="citybName" class="ct"  role='+g+">"+d.setInfo.city.name+'</span><span id="districtName" class="ds" role='+C+">"+d.setInfo.district.name+'</span><span id="detailAddress">'+h+"</span>"),i.find("em").html(f),n.removeClass("active"),ECity.API.setUserAddress(y),d.setDefaultAddress(d.setInfo,function(t){if("function"==e.type(l.adChangeCb))return l.adChangeCb(t)}),function(){var p=d.getInfo,u=p.province,y=p.city,m=p.district,f=[u.id,u.cid,"",u.name,u.defaultId].join(","),h=[y.id,y.cid,y.lesId,y.name,y.defaultId].join(","),v=[m.id,m.cid,m.lesId,m.name,m.defaultId].join(",");l.city?r.html('<li class="active" role='+f+'><p><a href="###">'+u.name+'</a><b class="arr"></b></p></li><li class="active current" role='+h+'><p><a href="###">'+y.name+'</a><b class="arr"></b></p></li>'):r.html('<li class="active"  role='+f+'><p><a href="###">'+u.name+'</a><b class="arr"></b></p></li><li class="active"  role='+h+'><p><a href="###">'+y.name+'</a><b class="arr"></b></p></li><li class="active current" role='+v+'><p><a href="###">'+m.name+'</a><b class="arr"></b></p></li>');if(o.removeClass("active").eq(2).addClass("active"),l.state){var g=e("<li></li>");o.eq(0).html("").append(g),d.getProvinceList(function(l){e.each(l,function(e,t){var i=[t.id,t.cid,"",t.name,t.defaultId].join(",");t.id==u.id?o.children(":eq(0)").append('<span><a name="item_none_dizhi_sheng" href="###" class="on" role='+i+">"+t.name+"</a></span>"):o.children(":eq(0)").append('<span><a name="item_none_dizhi_sheng" href="###" role='+i+">"+t.name+"</a></span>")}),a.append(o),d.getProvinces(n,t,i,a,r,o,s,c,function(){return d.getCities(r,a,o,n,i,function(){return d.getDistricts(r,a,i,n,function(){return d.setDetailAddress(i,r,a,n)})})})})}r.find("li").each(function(t){e(this).on("click",function(i){return e(this).hasClass("active")&&(e(this).addClass("current").siblings().removeClass("current"),a.children(":eq("+t+")").addClass("active").siblings().removeClass("active")),!1})})}()})})}return!1}),n.off("click.showMoreItem").on("click.showMoreItem","span.show-more",function(i){i&&i.stopPropagation();var n=e(this);n.toggleClass("wrapped");var o=n.closest(".ui-city-group-header");function a(){var e=o.find(".address-item a");if(e){var t=e.length;if(t>1)switch(t){case 2:o.find(".address-item").toggleClass("wrapped-2");break;case 3:o.find(".address-item").toggleClass("wrapped-3");break;case 4:o.find(".address-item").toggleClass("wrapped-4");break;default:o.find(".address-item").toggleClass("wrapped")}}}return ECity.setting.data.user.hasInit?d._getUserAddressList(s,c,t,l,a):d._getUserAddressList(s,c,t,l,!0,a),!1})},getCities:function(t,i,n,o,a,r){var s=this,c=this.opts,d=i.find(".ct-panel li"),l=i.find(".ds-panel li");i.find(".pr-panel a").on("click",function(n){n&&n.stopPropagation(),t.children(":eq(1)").find("a").html("请选择市").end().end().children(":eq(2)").removeClass("active").find("a").html("请选择县区"),e(this).addClass("on").parent().siblings().find("a").removeClass("on");var p=e(this).attr("role"),u=p.split(",");s.setInfo.province={id:u[0],cid:u[1],name:u[3],lesId:u[2]};var y=u[0],m=u[4],f=e(this).text();return d.html(""),s.getCityById(y,function(n){if(e.each(n,function(e,t){var i=[t.id,t.cid,t.lesId,t.name,t.defaultId].join(",");t.id==s.getInfo.city.id?d.append('<span><a name="item_none_dizhi_shi" href="###" class="on" role='+i+">"+t.name+"</a></span>"):d.append('<span><a name="item_none_dizhi_shi" href="###" role='+i+">"+t.name+"</a></span>")}),r(),1!==n.length)t.children(":eq(1)").addClass("active current"),i.find(".pr-panel").removeClass("active").end().find(".ct-panel").addClass("active");else{c.city&&o.removeClass("active");var l=[n[0].id+","+n[0].cid+","+n[0].name+","+n[0].defaultId].join(",");t.children(":eq(1)").attr("role",l).find("a").text(f),s.setInfo.city={id:n[0].id,cid:n[0].cid,name:n[0].name,lesId:n[0].lesId},s.getDefaultDistrict(n[0].defaultId,function(i){s.setInfo.district={id:i.id,cid:i.cid,name:i.name,lesId:i.lesId},c.city&&s.setDefaultAddress(s.setInfo,function(t){var i=a.find("span:eq(0)"),n=a.find("span:eq(1)");i.attr("role",s.setInfo.province.id+","+s.setInfo.province.cid+","+s.setInfo.province.name).text(s.setInfo.province.name),n.attr("role",s.setInfo.city.id+","+s.setInfo.city.cid+","+s.setInfo.city.name+","+s.setInfo.province.lesId).text(s.setInfo.city.name),i.text()==n.text()&&"吉林"!=e.trim(i)?a.find(".pr").addClass("dn"):a.find(".pr").removeClass("dn")}),"function"==e.type(c.cityCb)&&c.cityCb(s.getInfo),t.children(":eq(1)").removeClass("active")})}}),/^10\,|^20\,|^30,|^320\,/.test(y+",")?(s.changeFlag=!1,c.city||(t.children().eq(1).removeClass("active current").end().eq(2).addClass("current"),i.find(".pr-panel").removeClass("active").end().find(".ds-panel").addClass("active"),s.getDistrictsById(m,function(n){l.html(""),e.each(n,function(e,t){var i=[t.id,t.cid,t.lesId,t.name,t.defaultId].join(",");l.append('<span><a href="###" role='+i+">"+t.name+"</a></span>")}),"function"==e.type(c.cityCb)&&c.cityCb(s.getInfo),s.setDetailAddress(a,t,i,o)}),t.children(":eq(0)").addClass("active").removeClass("current"))):t.children(":eq(0)").removeClass("current"),t.children(":eq(0)").attr("role",p).find("a").text(f),!1});var p=s.getInfo.province.id,u=s.getInfo.city.id;s.getCityById(p,function(n){d.html(""),e.each(n,function(e,t){var i=[t.id,t.cid,t.lesId,t.name,t.defaultId].join(",");t.id==s.getInfo.city.id?d.append('<span><a name="item_none_dizhi_shi" href="###" class="on" role='+i+">"+t.name+"</a></span>"):d.append('<span><a name="item_none_dizhi_shi" href="###" role='+i+">"+t.name+"</a></span>")}),1==n.length?(t.children().eq(1).removeClass("active current"),t.children().eq(2).addClass("current"),i.find(".pr-panel").removeClass("active").end().find(".ds-panel").addClass("active")):t.children(":eq(1)").addClass("active"),c.city&&(1==n.length?(t.children(":eq(0)").addClass("active current").siblings().removeClass("active current"),i.children(":eq(0)").addClass("active").siblings().removeClass("active")):i.children(":eq(1)").addClass("active").siblings().removeClass("active")),r()}),s.getDistrictsById(u,function(n){l.html(""),e.each(n,function(e,t){var i=[t.id,t.cid,t.lesId,t.name,t.defaultId].join(",");t.id==s.getInfo.district.id?l.append('<span><a name="item_none_dizhi_qu" href="###" class="on" role='+i+">"+t.name+"</a></span>"):l.append('<span><a name="item_none_dizhi_qu" href="###" role='+i+">"+t.name+"</a></span>")}),s.setDetailAddress(a,t,i,o)})},getDistricts:function(t,i,n,o,a){var r=this,s=this.opts,c=i.find(".ds-panel li");i.find(".ct-panel a").on("click",function(d){r.changeFlag=!1,d&&d.stopPropagation(),e(this).addClass("on").parent().siblings().find("a").removeClass("on");var l=e(this).attr("role");r.setInfo.city={id:l.split(",")[0],cid:l.split(",")[1],lesId:l.split(",")[2],name:l.split(",")[3]};var p=l.split(",")[0],u=e(this).text();if(s.city){var y=l.split(",")[4];r.getDefaultDistrict(y,function(i){o.removeClass("active"),r.setInfo.district={id:i.id,cid:i.cid,name:i.name,lesId:i.lesId},t.children(":eq(1)").attr("role",l).find("a").text(u);var a=t.find("a:eq(0)").text(),c=t.find("a:eq(1)").text();r.setInfo.district.name;a==c&&"吉林"!=e.trim(a)?n.find(".pr").addClass("dn"):n.find(".pr").removeClass("dn"),n.find(".pr").text(a).end().find(".ct").text(c),r.setDefaultAddress(r.setInfo,function(e){var t=n.find("span:eq(0)"),i=n.find("span:eq(1)"),o=r.setInfo,a=o.province,s=o.city,c=[a.id,a.cid,a.name,""].join(","),d=[s.id,s.cid,s.name,"",s.lesId].join(",");t.attr("role",c).text(a.name).removeClass("dn"),i.attr("role",d).text(s.name)}),"function"==e.type(s.cityCb)&&s.cityCb(r.getInfo)})}else t.children(":eq(2)").find("a").html("请选择县区"),c.html(""),r.getDistrictsById(p,function(t){e.each(t,function(e,t){var i=[t.id,t.cid,t.lesId,t.name,t.defaultId].join(",");t.id==r.getInfo.district.id?c.append('<span><a name="item_none_dizhi_qu" href="###" class="on" role='+i+">"+t.name+"</a></span>"):c.append('<span><a name="item_none_dizhi_qu" href="###" role='+i+">"+t.name+"</a></span>")}),a(),"function"==e.type(s.cityCb)&&s.cityCb(r.getInfo)}),i.find(".ct-panel").removeClass("active").end().find(".ds-panel").addClass("active"),t.children(":eq(1)").addClass("active").removeClass("current").attr("role",l).find("a").text(u).end().end().children(":eq(2)").addClass("active current");return!1})},setDetailAddress:function(t,i,n,o){var a=this,r=this.opts;n.find(".ds-panel a").on("click",function(n){n&&n.stopPropagation(),o.removeClass("active"),e(this).addClass("on").parent().siblings().find("a").removeClass("on");var s=e(this).attr("role"),c=s.split(",");a.setInfo.district={id:c[0],cid:c[1],lesId:c[2],name:c[3]};c[0];var d=e(this).text(),l=i.find("a:eq(0)").text(),p=i.find("a:eq(1)").text(),u=(i.find("a:eq(2)").text(),a.getInfo),y=u.province,m=u.city,f=u.district,h=[y.id,y.cid,y.name].join(","),v=[m.id,m.cid,m.name,"",m.lesId].join(","),g=[f.id,f.cid,f.name,"",f.lesId].join(",");return i.children(":eq(2)").attr("role",s).find("a").text(d),l==p&&"吉林"!=e.trim(l)?t.find(".pr").addClass("dn"):t.find(".pr").removeClass("dn"),t.find(".pr").attr("role",h).text(l).end().find(".ct").attr("role",v).text(p).end().find(".ds").attr("role",g).text(d),r.used&&!r.city&&(t.find("#detailAddress").remove(),ECity.API.removeUserAddress()),a.setDefaultAddress(a.setInfo,function(t){"function"==e.type(r.distCb)&&"function"==e.type(r.changeCb)&&(0==a.changeFlag?(r.changeCb(t),a.changeFlag=!0):r.distCb(t))}),!1})},getAddressByDefault:function(e){ECity.API.getCity(function(t){return e(t)})},getUserAddressList:function(e){ECity.API.getUserAddressList(e)},getUsedAddress:function(e){return e(ECity.API.getLastUsedCities())},getUserSelectAddress:function(){return ECity.API.getUserSelectAddress()},getProvinceList:function(e){ECity.API.getProvinceList(function(t){return e(t)})},getCityById:function(e,t){ECity.API.getCityList(e,function(e){return t(e)})},getDistrictsById:function(e,t){ECity.API.getDistrictList(e,function(e){return t(e)})},setDefaultAddress:function(e,t){ECity.API.setCity(e,function(e){return t(e)})},getDefaultDistrict:function(e,t){ECity.API.getDistrict(e,function(e){return t(e)})},getCity:function(e){this.opts.getCity(e)},getInfoByCityid:function(e,t){ECity.API.getProvinceAndCityByCityId(e,function(e){var i=e.provinceAndCity,n={};n.province={id:i.pMdmId,cid:i.pMdmId,name:i.pName},n.city={id:i.cMdmId,cid:i.cCommerceId,name:i.cName},n.district={id:"",cid:"",name:""},t(n)})},_getUserAddressList:function(t,i,n,o,a,r){var s=this,c=s.getUserSelectAddress(),d=ECity.setting.data.user.hasInit;function l(a){if(c){n.html("");var s=ECity.API.util.formatShowUserAddress(c),d=c.cntctPointName+" "+s;n.append(e('<a name="item_none_dizhi_chy00" title="'+d+'" class="selected" data-addr="'+c.addrNum+'" href="javascript:;"><span class="name">'+c.cntctPointName+'</span><span class="address">'+s+"</span></a>")),a&&(t.append(n),o.used&&!o.city&&i.prepend(t),r(!1))}}function p(){s.getUserAddressList(function(a,s){if(a)return c||t.remove(),void r(!0);if(s&&s.length>0){n.html(""),l();for(var d=0,p=s.length;d<p;d++){var u=s[d];if(!c||c.addrNum!=u.addrNum){var y=ECity.API.util.formatShowUserAddress(u),m=u.cntctPointName+" "+y;n.append(e('<a name="item_none_dizhi_chy0'+(d+1)+'" title="'+m+'"  data-addr="'+u.addrNum+'" href="javascript:;"><span class="name">'+u.cntctPointName+'</span><span class="address">'+y+"</span></a>"))}}t.append(n),o.used&&!o.city&&ECity.API.util.isLogin()&&i.prepend(t),r(!1)}else c?l(!0):t.remove()})}"function"==typeof a?(r=a,a=null):r="function"==typeof r?r:e.noop,a||d?p():c?l(!0):p()}},window.mCity={},mCity.API={},mCity.API.getCity=function(e){ECity.API.getCity(function(t){return e(t)})},mCity.API.getCityId=function(){ECity.API.getCityId()},mCity.API.getDistrictId=function(){ECity.API.getDistrictId()},mCity.API.updateUserAddressCookie=function(e,t){ECity.setting.data.cookie.inited?ECity.API.updateUserAddressCookie(e,t):(ECity.API.init(),ECity.API.ipCookie.initCookie(function(){ECity.API.updateUserAddressCookie(e,t)}))};var i={city:!1,state:!0,used:!0,cityCb:e.noop,distCb:e.noop,getCity:e.noop,changeCb:e.noop,adChangeCb:e.noop,cityId:""},n=document.location.host,o=(document.location.hostname,document.location.protocol);document.location.port;/\.cnsuning\.com/gi.test(n)?n.indexOf("pre"):/\.suning\.com/gi.test(n),e.fn.mCity=function(e){try{ECity.API.init(e.city?e.city:i.city),this.each(function(){var n=jQuery.extend({},i,e);t().init(this,n)})}catch(e){}return this}}(jQuery);